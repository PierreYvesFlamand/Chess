function toggleModal({modal:e=null,winner:o=null,pawnToPromote:t=null}){const n=document.querySelector(".modal");n.style.display="none"===n.style.display?"flex":"none";const l={start:'\n            <h1>Chess</h1>\n            <h2>How to play</h2>\n            <ul>\n                <li>Hover a pawn to know which move it can performs</li>\n                <li>Click a pawn and then a square to move the pawn</li>\n            </ul>\n            <h2>Rules availables</h2>\n            <ul>\n                <li>Pawn promotion (reach ennemy last first row with a pawn to promote it)</li>\n                <li>Castling (click the king to perform it)</li>\n            </ul>\n            <button onclick="start_game()">Start the game</button>\n        ',end:`\n            <h1>Game end !</h1>\n            <h2>${o} player wins the game</h2>\n            <button onclick="location.reload()">Play again</button>\n        `,promotion:'\n            <h1>Pawn promotion !</h1>\n            <h2>Choose your promotion</h2>\n            <button id="promot-q">Queen</button>\n            <button id="promot-k">Knight</button>\n            <button id="promot-b">Bishop</button>\n            <button id="promot-r">Rook</button>\n        '};document.querySelector(".modal-card").innerHTML=e?l[e]:"",t&&(document.querySelector("#promot-q").addEventListener("click",()=>{pawn_promotion(t,"queen"),toggleModal({})}),document.querySelector("#promot-k").addEventListener("click",()=>{pawn_promotion(t,"knight"),toggleModal({})}),document.querySelector("#promot-b").addEventListener("click",()=>{pawn_promotion(t,"bishop"),toggleModal({})}),document.querySelector("#promot-r").addEventListener("click",()=>{pawn_promotion(t,"rook"),toggleModal({})}))}function start_game(){toggleModal({}),pawn_sellection(!0)}function next_turn(){currentPlayer=currentPlayer?0:1,pawn_sellection(!0)}function pawn_sellection(e){Pawns[currentPlayer].forEach(o=>{o.forEach(o=>{const t=calculate_possible_moves(o);if(0!=t.length){const n=document.getElementById(o.id);if(n.classList.toggle("is-askSelection"),e)n.addEventListener("click",function(){ask_possible_moves(o,t,!0),pawn_sellection(!1)}),n.addEventListener("mouseover",function(){show_possible_moves(t,!0)}),n.addEventListener("mouseout",function(){show_possible_moves(t,!1)});else{const e=n.cloneNode(!0);n.parentNode.replaceChild(e,n)}}})})}function show_possible_moves(e,o){e.forEach(e=>{const t=document.getElementById("pos-"+e.x+"-"+e.y);if(t.classList.toggle("is-possible-move"),!o){const e=t.cloneNode(!0);t.parentNode.replaceChild(e,t)}})}function ask_possible_moves(e,o,t){document.getElementById(e.id).classList.toggle("is-askedSelection"),document.getElementById("grid").classList.toggle("grid-disable"),o.forEach(n=>{const l=document.getElementById("pos-"+n.x+"-"+n.y);if(t)l.addEventListener("click",function(){ask_possible_moves(e,o,!1),move_pawn(e,n)});else{l.classList.toggle("is-possible-move");const e=l.cloneNode(!0);l.parentNode.replaceChild(e,l)}})}document.onreadystatechange=(()=>{"complete"===document.readyState&&(document.querySelector(".modal").style.display="none",toggleModal({modal:"start"}))});